#include <Gamebuino-Meta.h>

#define W 160
#define H 128

#define LAYER_WIDTH 30
#define LAYER_HEIGHT 20
uint8_t layer1[LAYER_HEIGHT][LAYER_WIDTH] = {
  {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  1,  5,  6,  7,  8,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  2, 13, 13, 13,  9,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  3, 13, 12, 13, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  4, 13, 13, 13, 11,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  2, 13, 13, 13,  9,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  3, 13, 13, 13, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  4, 13, 13, 13, 11,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  2, 13, 13, 13,  9,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  3, 13, 13, 13, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  4, 13, 13, 13, 11,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  2, 13, 13, 13,  9,  0,  0,  0,  0,  0,  0,  0,  1,  5,  6,  7,  8,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  3, 13, 13, 13, 10,  0,  0,  0,  0,  0,  0,  0,  2, 13, 13, 13,  9,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  4, 13, 13, 13, 11,  0,  0,  0,  0,  0,  0,  0,  3, 13, 13, 13, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  2, 13, 13, 13,  9,  0,  0,  0,  0,  0,  0,  0,  4, 13, 13, 13, 11,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  3, 13, 13, 13, 10,  0,  0,  0,  0,  0,  0,  0,  2, 13, 13, 12,  9,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  4, 13, 13, 13, 11,  0,  0,  0,  0,  0,  0,  0,  3, 13, 13, 13, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  2, 13, 13, 13,  9,  0,  0,  1,  5,  6,  7,  5,  6,  7,  5,  6,  7,  8,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  3, 13, 13, 13, 10,  0,  0,  2, 13, 13, 13, 13, 13, 13, 13, 13, 13,  9,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
  {  0,  4, 12, 13, 13, 11,  0,  0,  3, 13, 13, 13, 13, 13, 13, 13, 13, 13, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0}
  
};

uint8_t layer2[20][28] = {
  { 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29 },
  { 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29 },
  { 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29 },
  { 29, 29, 14, 18, 19, 20, 21, 22, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29 },
  { 29, 29, 15, 28, 28, 28, 28, 23, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29 },
  { 29, 29, 16, 28, 28, 27, 28, 24, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29 },
  { 29, 29, 17, 28, 28, 28, 28, 25, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29 },
  { 29, 29, 15, 28, 28, 28, 28, 23, 14, 18, 19, 20, 21, 18, 19, 20, 21, 18, 19, 20, 21, 18, 19, 20, 21, 18, 19, 20 },
  { 29, 29, 16, 28, 26, 28, 28, 24, 15, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 17, 28, 28, 28, 28, 25, 16, 28, 28, 28, 28, 28, 28, 28, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 15, 28, 28, 28, 28, 23, 17, 28, 28, 28, 26, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 16, 28, 28, 28, 28, 24, 15, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 17, 28, 28, 28, 28, 25, 16, 28, 28, 28, 28, 28, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 15, 28, 28, 28, 26, 23, 17, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 16, 28, 28, 28, 28, 24, 15, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 17, 28, 28, 28, 28, 25, 16, 28, 28, 28, 28, 28, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 15, 28, 28, 28, 26, 23, 17, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 16, 28, 28, 28, 28, 24, 15, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 17, 28, 28, 28, 28, 25, 16, 28, 28, 28, 28, 28, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 },
  { 29, 29, 15, 28, 28, 28, 26, 23, 17, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28 }
};

int offsetX;
int offsetY;
  
const uint16_t sample_tilesData[] = {8,8,30, 0, 0x7e0, 0, 0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0x7e0,0xc287,0xec48,0xec48,0xc287,0xc287,0xc287,0x7e0,0xc287,0x8167,0xec48,0xec48,0x8167,0x8167,0xec48,0x7e0,0x8167,0x8167,0xc287,0xc287,0x8167,0xc287,0xec48,0xc287,0x8167,0x316a,0x8167,0x8167,0x316a,0xc287,0xc287,0x8167,0x8167,0xec48,0xc287,0x316a,0x8167,0x8167,0xc287,0x7e0,0x8167,0xc287,0xc287,0x8167,0x8167,0x8167,0x316a,0xc287,0xec48,0x8167,0x2106,0x8167,0x8167,0x8167,0x316a,0x8167,0xc287,0x8167,0x2106,0x2106,0x316a,0x316a,0x316a,0x7e0,0x316a,0x2106,0x8167,0x316a,0x2106,0x2106,0x2106,0x7e0,0x316a,0x2106,0x316a,0x316a,0x2106,0x2106,0x2106,0x7e0,0xc287,0xc287,0x8167,0x2106,0x2106,0x2106,0x2106,0x7e0,0xc287,0xc287,0x316a,0x2106,0x2106,0x2106,0x2106,0x7e0,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0x2106,0x7e0,0x7e0,0x316a,0x2106,0x316a,0x2106,0x2106,0x2106,0x7e0,0x7e0,0xc287,0x8167,0x2106,0x316a,0x2106,0x2106,0x7e0,0x316a,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0xc287,0x8167,0x316a,0x2106,0x316a,0x2106,0x2106,0x2106,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x7e0,0x316a,0x316a,0x8167,0x2106,0x2106,0x2106,0x2106,0x7e0,0xc287,0x8167,0x316a,0x2106,0x2106,0x2106,0x2106,0x7e0,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0x2106,0x7e0,0x7e0,0x316a,0x2106,0x316a,0x2106,0x2106,0x2106,0xc287,0x8167,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x7e0,0x316a,0x2106,0x8167,0x316a,0x2106,0x2106,0x2106,0x7e0,0x2106,0x2106,0x316a,0x316a,0x2106,0x2106,0x2106,0x7e0,0x316a,0x316a,0x8167,0x2106,0x2106,0x2106,0x2106,0x7e0,0xc287,0x8167,0x316a,0x2106,0x2106,0x2106,0x2106,0x7e0,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0x2106,0x7e0,0x7e0,0x316a,0x2106,0x316a,0x2106,0x2106,0x2106,0x7e0,0x316a,0xc287,0x8167,0x2106,0x316a,0x2106,0x2106,0x7e0,0x316a,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0xc287,0xc287,0xec48,0xec48,0xc287,0xc287,0xc287,0xc287,0xec48,0x8167,0xc287,0xc287,0x8167,0xec48,0xec48,0x8167,0xec48,0xc287,0x8167,0x8167,0xc287,0xec48,0xec48,0xc287,0xc287,0xc287,0x316a,0x8167,0xc287,0xc287,0xc287,0xc287,0xc287,0x8167,0x316a,0x316a,0x8167,0xc287,0xc287,0x8167,0x8167,0x316a,0x8167,0x8167,0x316a,0x8167,0x8167,0x2106,0x316a,0x2106,0x8167,0x8167,0x2106,0x316a,0x316a,0x2106,0x2106,0x2106,0x316a,0x316a,0x2106,0x316a,0x2106,0x316a,0xc287,0xc287,0xec48,0xec48,0xc287,0xc287,0xc287,0xc287,0xec48,0x8167,0xc287,0xc287,0x8167,0xec48,0xec48,0x8167,0xec48,0xc287,0x8167,0x8167,0xc287,0xec48,0xec48,0xc287,0xc287,0xc287,0x316a,0x8167,0xc287,0xc287,0xc287,0xc287,0xc287,0x8167,0x316a,0x316a,0x8167,0xc287,0xc287,0x8167,0x8167,0x316a,0x8167,0x8167,0x316a,0x8167,0x8167,0x2106,0x316a,0x2106,0x8167,0x8167,0x2106,0x316a,0x316a,0x2106,0x2106,0x2106,0x316a,0x316a,0x2106,0x316a,0x2106,0x316a,0xec48,0xc287,0xc287,0xec48,0xec48,0xc287,0xc287,0xc287,0xc287,0xc287,0x8167,0xec48,0xec48,0x8167,0x8167,0xec48,0x8167,0x8167,0x8167,0xc287,0xc287,0x8167,0xc287,0xec48,0x8167,0xec48,0xec48,0x8167,0x8167,0x316a,0xc287,0xc287,0x8167,0xc287,0xc287,0x8167,0x316a,0x8167,0x8167,0xc287,0x2106,0x8167,0x8167,0x316a,0x2106,0x8167,0x8167,0x316a,0x2106,0x316a,0x316a,0x316a,0x2106,0x316a,0x316a,0x2106,0x316a,0x2106,0x316a,0x316a,0x2106,0x2106,0x2106,0x2106,0xc287,0xc287,0xec48,0xec48,0xc287,0xc287,0x7e0,0x7e0,0xec48,0x8167,0xc287,0xc287,0x8167,0xec48,0xec48,0x7e0,0xec48,0xc287,0x8167,0x8167,0xc287,0xec48,0xec48,0xc287,0xc287,0xc287,0x316a,0x8167,0xc287,0xc287,0xc287,0xc287,0xc287,0x8167,0x316a,0x316a,0x8167,0xc287,0xc287,0x8167,0x8167,0x316a,0x8167,0x8167,0x316a,0x8167,0x8167,0x7e0,0x316a,0x2106,0x8167,0x8167,0x2106,0x316a,0xc287,0xec48,0x2106,0x2106,0x316a,0x316a,0x2106,0x316a,0x8167,0xc287,0x2106,0x2106,0x2106,0x316a,0x8167,0x2106,0x316a,0x7e0,0x2106,0x2106,0x2106,0x316a,0x316a,0x316a,0x7e0,0x7e0,0x2106,0x2106,0x2106,0x2106,0x8167,0xc287,0xec48,0x7e0,0x2106,0x2106,0x2106,0x2106,0x316a,0xc287,0xc287,0x7e0,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x7e0,0x2106,0x2106,0x2106,0x316a,0x2106,0x316a,0x7e0,0x7e0,0x2106,0x2106,0x316a,0x2106,0x8167,0xc287,0x7e0,0x7e0,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x7e0,0x7e0,0x2106,0x2106,0x2106,0x316a,0x2106,0x8167,0xc287,0x7e0,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x7e0,0x2106,0x2106,0x2106,0x2106,0x8167,0x316a,0x7e0,0x7e0,0x2106,0x2106,0x2106,0x2106,0x316a,0x8167,0xc287,0x7e0,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x7e0,0x2106,0x2106,0x2106,0x316a,0x2106,0x316a,0x7e0,0x7e0,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0xc287,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x2106,0x2106,0x2106,0x316a,0x8167,0x8167,0xc287,0x7e0,0x2106,0x2106,0x2106,0x316a,0x316a,0x8167,0x8167,0x7e0,0x2106,0x2106,0x2106,0x2106,0x8167,0x316a,0x7e0,0x7e0,0x2106,0x2106,0x2106,0x2106,0x316a,0x8167,0xc287,0x7e0,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x7e0,0x2106,0x2106,0x2106,0x316a,0x2106,0x7e0,0x7e0,0x7e0,0x2106,0x2106,0x316a,0x2106,0x8167,0xc287,0x7e0,0x7e0,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x316a,0x7e0,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x8167,0x8167,0x2106,0x2106,0x2106,0x2106,0x8167,0x2106,0x316a,0x316a,0x2106,0x2106,0x2106,0x2106,0x316a,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x2106,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x2c06,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x2c06,0x2c06,0x316a,0x326e,0x326e,0x326e,0x326e,0x326e,0x2287,0x2c06,0x316a,0x326e,0x326e,0x326e,0x2c06,0x316a,0x316a,0x2287,0x2287,0x326e,0x326e,0x326e,0x2287,0x2c06,0x316a,0x316a,0x2287,0x326e,0x326e,0x326e,0x316a,0x2287,0x316a,0x2287,0x316a,0x326e,0x2c06,0x2c06,0x2287,0x316a,0x316a,0x316a,0x316a,0x326e,0x326e,0x2c06,0x2287,0x316a,0x2287,0x2287,0x316a,0x326e,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x2c06,0x2287,0x316a,0x2287,0x2287,0x316a,0x316a,0x2c06,0x2c06,0x2287,0x316a,0x316a,0x2287,0x316a,0x316a,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x316a,0x2c06,0x2287,0x316a,0x2287,0x316a,0x316a,0x2c06,0x2c06,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x2c06,0x2287,0x316a,0x2287,0x316a,0x316a,0x316a,0x326e,0x316a,0x316a,0x316a,0x2287,0x2287,0x316a,0x316a,0x326e,0x316a,0x2c06,0x2287,0x316a,0x2287,0x316a,0x316a,0x326e,0x2c06,0x2c06,0x2287,0x316a,0x316a,0x316a,0x316a,0x326e,0x326e,0x316a,0x316a,0x316a,0x2287,0x2287,0x316a,0x2c06,0x2c06,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x2c06,0x2287,0x316a,0x2287,0x2287,0x316a,0x316a,0x326e,0x326e,0x316a,0x2c06,0x2287,0x316a,0x316a,0x316a,0x326e,0x2c06,0x2c06,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x316a,0x2c06,0x2287,0x316a,0x316a,0x316a,0x316a,0x326e,0x326e,0x316a,0x316a,0x2287,0x316a,0x316a,0x316a,0x326e,0x2c06,0x2287,0x316a,0x2287,0x2287,0x316a,0x316a,0x2c06,0x2c06,0x2287,0x316a,0x316a,0x2287,0x316a,0x316a,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x316a,0x2c06,0x2287,0x316a,0x316a,0x316a,0x316a,0x326e,0x326e,0x326e,0x326e,0x2c06,0x326e,0x326e,0x2c06,0x326e,0x326e,0x326e,0x2c06,0x2c06,0x326e,0x2c06,0x2c06,0x2c06,0x326e,0x316a,0x2287,0x2287,0x316a,0x2c06,0x2287,0x2287,0x2c06,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x2287,0x316a,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x2287,0x316a,0x2287,0x2287,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x2287,0x316a,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x2c06,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x316a,0x2c06,0x2c06,0x326e,0x2c06,0x326e,0x326e,0x2c06,0x316a,0x2287,0x2287,0x316a,0x2287,0x2c06,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x316a,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x2287,0x2287,0x316a,0x2287,0x316a,0x2287,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2c06,0x326e,0x2c06,0x326e,0x326e,0x326e,0x326e,0x2c06,0x2c06,0x316a,0x2c06,0x2c06,0x326e,0x2287,0x2c06,0x2c06,0x2287,0x316a,0x2287,0x2287,0x326e,0x2287,0x2287,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x316a,0x316a,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x2287,0x2287,0x316a,0x2287,0x316a,0x2287,0x2287,0x316a,0x316a,0x316a,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2c06,0x326e,0x326e,0x2c06,0x326e,0x326e,0x326e,0x326e,0x2c06,0x2c06,0x326e,0x2c06,0x2c06,0x326e,0x326e,0x326e,0x2287,0x2c06,0x316a,0x2287,0x2287,0x316a,0x326e,0x2c06,0x316a,0x2287,0x316a,0x316a,0x316a,0x316a,0x2c06,0x2287,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x2287,0x2287,0x2287,0x316a,0x2287,0x2287,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x316a,0x316a,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x2c06,0x326e,0x326e,0x326e,0x326e,0x326e,0x316a,0x2c06,0x2c06,0x326e,0x326e,0x326e,0x326e,0x326e,0x316a,0x2c06,0x2287,0x326e,0x326e,0x326e,0x326e,0x326e,0x2287,0x2287,0x316a,0x316a,0x2c06,0x326e,0x326e,0x326e,0x2287,0x316a,0x316a,0x2c06,0x2287,0x326e,0x326e,0x326e,0x316a,0x2287,0x316a,0x2287,0x316a,0x326e,0x326e,0x326e,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x2c06,0x326e,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x326e,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x326e,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x2c06,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x2c06,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x316a,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x2c06,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x2c06,0x326e,0x316a,0x316a,0x316a,0x2287,0x316a,0x316a,0x316a,0x326e,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x316a,0x326e,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x2c06,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x2c06,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x2c06,0x326e,0x316a,0x316a,0x316a,0x2287,0x2c06,0x316a,0x326e,0x326e,0x316a,0x316a,0x316a,0x316a,0x316a,0x2c06,0x2c06,0x326e,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x316a,0x326e,0x316a,0x316a,0x316a,0x2287,0x316a,0x316a,0x326e,0x326e,0x316a,0x316a,0x2287,0x2287,0x316a,0x2287,0x2c06,0x326e,0x316a,0x316a,0x2287,0x316a,0x316a,0x2287,0x2c06,0x2c06,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x316a,0x326e,0x316a,0x2c06,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x2c06,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x2c06,0x2c06,0x316a,0x316a,0x316a,0x316a,0x2287,0x2287,0x2c06,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2c06,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2c06,0x2c06,0x316a,0x316a,0x2c06,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x2287,0x2c06,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x316a,0x316a,0x316a,0x2287,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x2287,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x316a,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e,0x326e};
Image sample_tiles = Image(sample_tilesData);
Image buffer1(W, 8);
Image buffer2(W, 8);

void setup() {
  gb.begin();
  gb.display.init(0, 0, ColorMode::rgb565);
  
  SerialUSB.begin(9600);
}

void loop() {
  while (!gb.update());

  if (gb.buttons.repeat(Button::right, 0)) {
    if (LAYER_WIDTH * 8 - offsetX > W) {
      offsetX += 1;
    }
  }
  if (gb.buttons.repeat(Button::left, 0)) {
    if (offsetX > 0) {
      offsetX -= 1;
    }
  }
  if (gb.buttons.repeat(Button::down, 0)) {
    if (LAYER_HEIGHT * 8 - offsetY > H) {
      offsetY += 1;
    }
  }
  if (gb.buttons.repeat(Button::up, 0)) {
    if (offsetY > 0) {
      offsetY -= 1;
    }
  }
  
  draw();

  if (gb.frameCount % 25 == 0) SerialUSB.printf("CPU: %i\n", gb.getCpuLoad());
}

void draw() {

  for (int row = 0; row < H / 8; row++) {
    Image *buffer = row % 2 == 0 ? &buffer1 : &buffer2;
    
    int xStart = offsetX / 16;
    int xEnd = xStart + W / 8;
    int yStart = offsetY / 16 + row;
    int yEnd = yStart + 1;

    for (int y = yStart; y <= yEnd; y++) {
      for (int x = xStart; x <= xEnd; x++) {
        sample_tiles.setFrame(layer2[y][x]);
        buffer->drawImage(x * 8 - offsetX / 2, (y * 8 - offsetY / 2) - row * 8, sample_tiles);
      }
    }

    xStart = offsetX / 8;
    xEnd = xStart + W / 8;
    yStart = offsetY / 8 + row;
    yEnd = yStart + 1;
    
    for (int y = yStart; y <= yEnd; y++) {
      for (int x = xStart; x <= xEnd; x++) {
        sample_tiles.setFrame(layer1[y][x]);
        buffer->drawImage(x * 8 - offsetX, (y * 8 - offsetY) - row * 8, sample_tiles);
      }
    }

    gb.tft.andy();
    gb.tft.drawBuffer(0, row * 8, buffer->_buffer, 160, 8);
  }
  
}

